{"meta":{"title":"凡所有相，皆是虚妄。若见诸相非相，即见如来","subtitle":null,"description":null,"author":"影风","url":"http://yoursite.com"},"pages":[],"posts":[{"title":"test","slug":"test","date":"2019-04-25T11:06:19.000Z","updated":"2019-04-25T11:10:00.281Z","comments":false,"path":"2019/04/25/test/","link":"","permalink":"http://yoursite.com/2019/04/25/test/","excerpt":"","text":"This is a test","categories":[{"name":"前端","slug":"前端","permalink":"http://yoursite.com/categories/前端/"}],"tags":[{"name":"JAVA","slug":"JAVA","permalink":"http://yoursite.com/tags/JAVA/"}],"keywords":[{"name":"前端","slug":"前端","permalink":"http://yoursite.com/categories/前端/"}]},{"title":"Hello World","slug":"hello-world","date":"2019-04-25T08:44:08.320Z","updated":"2019-04-25T08:44:08.321Z","comments":true,"path":"2019/04/25/hello-world/","link":"","permalink":"http://yoursite.com/2019/04/25/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[],"keywords":[]},{"title":"CentOS搭建Redis集群","slug":"CentOS搭建Redis集群","date":"2018-04-28T16:58:48.000Z","updated":"2019-04-28T17:00:41.247Z","comments":false,"path":"2018/04/29/CentOS搭建Redis集群/","link":"","permalink":"http://yoursite.com/2018/04/29/CentOS搭建Redis集群/","excerpt":"","text":"下载源码并解压编译123456789yum -y install gcc automake autoconf libtool makemkdir -p /usr/local/rediscd /usr/local/rediswget http://download.redis.io/releases/redis-5.0.0.tar.gztar xzf redis-5.0.0.tar.gzcd redis-5.0.0make MALLOC=libc 创建Redis配置文件1234567891011121314151617181920mkdir -p /usr/local/redis/redis-cluster-conf/7001mkdir -p /usr/local/redis/redis-cluster-conf/7002mkdir -p /usr/local/redis/redis-cluster-conf/7003mkdir -p /usr/local/redis/redis-cluster-conf/7004mkdir -p /usr/local/redis/redis-cluster-conf/7005mkdir -p /usr/local/redis/redis-cluster-conf/7006vim redis.conf## 配置文件的内容为：## 其中 port 和 pidfile 需要随着 文件夹的不同调增。port 7001bind 192.168.6.223cluster-enabled yescluster-config-file nodes.confcluster-node-timeout 5000appendonly yesdaemonize yesprotected-mode nopidfile /var/run/redis_7001.pid 启动节点123456/usr/local/redis/redis-5.0.0/src/redis-server /usr/local/redis/redis-cluster-conf/7001/redis.conf/usr/local/redis/redis-5.0.0/src/redis-server /usr/local/redis/redis-cluster-conf/7002/redis.conf/usr/local/redis/redis-5.0.0/src/redis-server /usr/local/redis/redis-cluster-conf/7003/redis.conf/usr/local/redis/redis-5.0.0/src/redis-server /usr/local/redis/redis-cluster-conf/7004/redis.conf/usr/local/redis/redis-5.0.0/src/redis-server /usr/local/redis/redis-cluster-conf/7005/redis.conf/usr/local/redis/redis-5.0.0/src/redis-server /usr/local/redis/redis-cluster-conf/7006/redis.conf 启动集群1234## 3个master 3个slave/usr/local/redis/redis-5.0.0/src/redis-cli --cluster create 192.168.6.223:7001 192.168.6.223:7002 192.168.6.223:7003 192.168.6.223:7004 192.168.6.223:7005 192.168.6.223:7006 --cluster-replicas 1type yes 连接集群12345./redis-cli -h 192.168.6.223 -c -p 7001## 测试在7001上set a \"yjj\"在7003上get a","categories":[{"name":"运维","slug":"运维","permalink":"http://yoursite.com/categories/运维/"}],"tags":[{"name":"集群","slug":"集群","permalink":"http://yoursite.com/tags/集群/"}],"keywords":[{"name":"运维","slug":"运维","permalink":"http://yoursite.com/categories/运维/"}]},{"title":"MySQL数据库设计规范","slug":"MySQL数据库设计规范","date":"2018-04-26T08:36:36.000Z","updated":"2019-04-26T09:27:22.895Z","comments":false,"path":"2018/04/26/MySQL数据库设计规范/","link":"","permalink":"http://yoursite.com/2018/04/26/MySQL数据库设计规范/","excerpt":"","text":"数据库命名规范 所有数据库对象名称必须小写 命名要做到见名识意，禁止使用MySQL保留关键字 临时表以tmp_开头，备份表以bak_开头并以时间戳结尾 所有存储相同数据的列名和列类型必须一致 数据库基本设计规范 所有表必须使用Innodb存储引擎 支持事务，行级锁，更好的恢复性，高并发下性能更好 show engines; 数据库和表的字符集统一使用UTF-8 避免由于字符集转换产生乱码 汉字占3个字节，ASCII码占1个字节 所有表和字段必须添加注释 尽量控制单表数据量的大小，建议控制在500万行以内 可以用历史数据归档，分库分表等手段来控制数据量大小 谨慎使用MySQL分区表 分区表在物理上表现为多个文件，在逻辑上表现为一个表 跨分区查询效率会低 建议采用物理分表的方式管理大数据 尽量做到冷热数据分离，减小表宽度 减少磁盘I/O，保证热数据的内存缓存命中率 更有效的利用缓存，避免读入无用的冷数据 经常一起使用的列放到一个表中 禁止在表中建立预留字段 禁止在数据库中存储图片，文件等二进制数据 禁止在线上做数据库压力测试 禁止从开发环境、测试环境直连生产环境数据库 数据库索引设计规范 限制每张表上的索引数量，建议单张表索引不超过5个 禁止给表中的每一列都建立单独的索引 每张表都必须有一个主键 不使用更新频繁的列作为主键 不使用多列主键 不使用UUID，MD5，HASH，字符串作为主键 主键建议使用自增id值 WHERE从句、ORDER BY、GROUP BY、DISTINCT、多表JOIN中的列优先设置索引 设置索引列的顺序 区分度最高的列放在联合索引的最左侧 尽量把字段长度小的列放在联合索引的最左侧 使用最频繁的列放到联合索引的左侧 避免建立冗余索引和重复索引 primary key(id)、index(id)、unique index(id) index(a,b,c)、index(a,b)、index(a) 对于频繁的查询优先考虑使用覆盖索引 避免Innodb表进行索引的二次查找 可以把随机I/O变为顺序I/O加快查询效率 尽量避免使用外键 外键可用于保证数据的参照完整性，但建议在业务端实现 外键会影响父表和子表的写操作从而降低性能 数据库字段设计规范 优先选择符合存储需要的最小的数据类型 将字符串转化为数字类型存储，INET_ATON(‘255.255.255.255’)，INET_NTOA(4294967295) 对于非负整数应采用无符号整型进行存储 VARCHAR(N)中的N指定要明确，过大的长度会消耗更多的内存 避免使用TEXT、BLOB数据类型 建议把BLOB或者TEXT分离到单独的扩展表中 TEXT或BLOB类型只能使用前缀索引 避免使用ENUM数据类型 尽可能把所有列定义为NOT NULL 索引NULL列需要额外的空间来保存 进行比较和计算要对NULL值做特别的处理 不要用字符串存储日期类型的数据 无法用日期函数进行计算和比较 用字符串存储日期要占更多的空间 使用TIMESTAMP或DATETIME类型存储时间 TIMESTAMP占用4字节和INT相同，但比INT可读性高 超出TIMESTAMP取值范围的时候用DATETIME TIMESTAMP 1970～01～01 ～ 2038-01-19 财务相关的金额类数据，必须使用decimal类型 SQL开发规范 建议使用预编译语句进行数据库操作 避免数据类型的隐式转换 select phone from user where id = ‘1’ 充分利用表上已经存在的索引 避免使用双%号的查询条件 使用left join 或 not exists 优化not in操作 禁止跨库查询 禁止使用SELECT *，必须使用SELECT &lt;字段列表&gt; 查询 禁止使用不含字段列表的INSERT语句 避免使用子查询，可以把子查询优化为join操作 避免使用JOIN关联太多的表，建议不超过5个 合并多个相同操作到一起，减少同数据库交互次数 使用in代替or，in的值不要超过500，in操作可以利用索引 禁止使用order by rand() 进行随机排序 WHERE从句中禁止队列进行函数转换和计算 where date(time) = ‘20160901’ where createtime &gt;= ‘20160901’ and createtime &lt; ‘20160902’ 在明显不会有重复值时使用UNION ALL，而不是UNION 拆分复杂的大SQL为多个小SQL 一个SQL只能使用一个CPU进行计算 数据库操作规范 超过100万行的批量写操作，要分批多次进行操作 大批量操作可能会造成严重的主从延迟 binlog日志为ROW格式会产生大量的日志 避免产生大事务操作 对大表数据结构的修改要谨慎，会造成严重的锁表操作 使用pt-online-schema-change修改表结构 禁止为程序使用的账号赋予super权限 程序使用的账号原则上不准有drop权限","categories":[{"name":"数据库","slug":"数据库","permalink":"http://yoursite.com/categories/数据库/"}],"tags":[{"name":"MySQL","slug":"MySQL","permalink":"http://yoursite.com/tags/MySQL/"}],"keywords":[{"name":"数据库","slug":"数据库","permalink":"http://yoursite.com/categories/数据库/"}]}]}